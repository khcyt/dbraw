const kh_global=Function("return globalThis;")()||Function("return this;")()||Function("return self;")();const as_module=undefined==this;const asWorker="undefined"===typeof window&&"undefined"===typeof process&&self;const cf="kh_server";const mf="common_sheetjs_utils_esm";kh_global.kh??={};kh_global.kh.context??="undefined"!==typeof window?kh_global.parent==kh_global?"window":"iframe":"undefined"!==typeof process?"node.js":"undefined"!==typeof self?self.name??"worker":"unknown";kh_global.kh.storage??={};const cs=kh_global.kh.storage[cf]??={cf,ms:new Set};const ms=kh_global.kh.storage[mf]??={mf,cs};cs.ms.add(ms);let print_level=undefined;import{Logger}from"/contrib/jsm/kh_log.js";const kh_log=new Logger(print_level,()=>name);const name=MF`${mf}`;export function calcColWidth(rows){const col_widths_max=[...Array(rows[0]?.length??0)].map(_=>0);rows.forEach(row=>row.forEach((col,col_index)=>{let len=0;switch(typeof col){case"number":len=10;break;case"string":len=Math.round(1.1*col.length)|0;break;case"object":if(col instanceof Date)len=10;break;default:debugger}col_widths_max[col_index]=Math.max(len,col_widths_max[col_index])}));return col_widths_max.map(col_width=>({wch:col_width}))}kh_global.LoadedScripts.get(mf).resolve(ms);