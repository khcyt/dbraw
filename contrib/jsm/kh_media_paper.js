const kh_global=Function("return globalThis;")()||Function("return this;")()||Function("return self;")();const as_module=undefined==this;const asWorker="undefined"===typeof window&&"undefined"===typeof process&&self;const cf="kh_media";const mf="kh_media_paper_esm";kh_global.kh??={};kh_global.kh.context??="undefined"!==typeof window?kh_global.parent==kh_global?"window":"iframe":"undefined"!==typeof process?"node.js":"undefined"!==typeof self?self.name??"worker":"unknown";kh_global.kh.storage??={};const cs=kh_global.kh.storage[cf]??={cf,ms:new Set};const ms=kh_global.kh.storage[mf]??={mf,cs};cs.ms.add(ms);let jsm_prefix;let common_prefix;let npm_prefix;if("undefined"!==typeof process){jsm_prefix=`file:///${kh_global.kh.pathes.get("own-module")}`;common_prefix=`file:///${kh_global.kh.pathes.get("common")}`;npm_prefix=`file:///${kh_global.kh.pathes.get("node-module")}`}else{jsm_prefix=nodeFN2ZK(`/contrib/jsm`)}const kh_js={...await import(`${jsm_prefix}/kh_earlybird${VERSION}.js`),...await import(`${jsm_prefix}/kh_functions${VERSION}.js`),...await import(`${jsm_prefix}/kh_classes${VERSION}.js`),...await import(`${jsm_prefix}/kh_classes2${VERSION}.js`)};const print_level=undefined;const{Logger}=await import(`${jsm_prefix}/kh_log${VERSION}.js`);const kh_log=new Logger(print_level,(()=>name));const name=MF`${mf}`;export class paper{#paper_;static#papers_=new Map([["a5",{height:210,width:148.5}],["a4",{height:297,width:210}],["a3",{height:420,width:297}],["a2",{height:594,width:420}],["a1",{height:841,width:594}],["a0",{height:1189,width:841}]].map((([k,v])=>[k,{...v,orientation:"portrait",format:k}])));constructor({height,width,format,orientation="portrait",margins={top:20,right:25,bottom:20,left:25}}){if(1==arguments.length&&kh_js.isString(arguments[0]))format=arguments[0];const known_paper=paper.#papers_.get(format);if(!kh_js.isNumber(height)&&!kh_js.isNumber(width)){if(kh_js.isValid(known_paper)){this.#paper_={format,margins,...known_paper};this.setOrientation(orientation)}else throw new kh_js.Error({msg:"param-invalid"})}else{if(kh_js.isValid(known_paper)){this.#paper_={format,margins,...known_paper,height,width};this.setOrientation(orientation)}else{paper.#papers_.set(format,this.#paper_={height,width,format,orientation})}}}get format(){return this.#paper_.format}get orientation(){return this.#paper_.orientation}get height(){return+this.#paper_.height}get width(){return+this.#paper_.width}get margins(){return this.#paper_.margins}set orientation(orientation){this.#paper_.orientation=orientation}set height(height){this.#paper_.height=+height}set width(width){this.#paper_.width=+width}set margins(margins){this.#paper_.margins={...this.#paper_.margins,...margins}}effectiveSize(){return{height:this.height-this.margins.top-this.margins.bottom,width:this.width-this.margins.left-this.margins.right}}swap(){this.setOrientation("portrait"==this.orientation?"landscape":"portrait")}setOrientation(orientation="portrait"){if(this.orientation!==orientation){this.orientation=orientation;[this.width,this.height]=[this.height,this.width]}}}kh_global.LoadedScripts.get(mf).resolve(ms);