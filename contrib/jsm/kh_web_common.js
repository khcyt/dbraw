const kh_global=Function("return globalThis;")()||Function("return this;")()||Function("return self;")();const as_module=undefined==this;const asWorker="undefined"===typeof window&&"undefined"===typeof process&&self;const cf="kh_web";const mf="kh_web_common_esm";kh_global.kh??={};kh_global.kh.context??="undefined"!==typeof window?kh_global.parent==kh_global?"window":"iframe":"undefined"!==typeof process?"node.js":"undefined"!==typeof self?self.name??"worker":"unknown";kh_global.kh.storage??={};const cs=kh_global.kh.storage[cf]??={cf,ms:new Set};const ms=kh_global.kh.storage[mf]??={mf,cs};cs.ms.add(ms);let jsm_prefix;let common_prefix;if("undefined"!==typeof process){jsm_prefix=`file:///${kh_global.kh.pathes.get("own-module")}`;common_prefix=`file:///${kh_global.kh.pathes.get("common")}`}else{jsm_prefix=nodeFN2ZK(`/contrib/jsm`)}const kh_js={...await import(`${jsm_prefix}/kh_earlybird${VERSION}.js`),...await import(`${jsm_prefix}/kh_functions${VERSION}.js`),...await import(`${jsm_prefix}/kh_classes${VERSION}.js`)};const name=MF`${mf}`;const print_level=undefined;const{Logger}=await import(`${jsm_prefix}/kh_log${VERSION}.js`);const kh_log=new Logger(print_level,(()=>name));const kh_io={...await import(`${jsm_prefix}/kh_io${VERSION}.js`)};const{vjs}="undefined"!==typeof process?{}:await import(`${jsm_prefix}/kh_vanilla${VERSION}.js`);export function unzip(storage,label_key,element){return!kh_js.isString(label_key)?undefined:kh_global.kh.storage.kh_js.unzipProp(label_key,true,element||getMainWindow(storage))}export function unzipProp(storage,prop,element){return kh_global.kh.storage.kh_js.unzipProp(prop,false,element||getMainWindow(storage))}export function getMainWindow(storage){if(kh_js.isNode()||!kh_js.isValid(storage))return undefined;const key=`${storage.cf}-mainw`;if(!kh_js.isValid(storage[key])){storage[key]=vjs(`#${unzip(storage,"id.main.win",true)}`,false)}return storage[key]}export function processTagged(storage,strings,...keys){if(kh_js.isEmpty(strings)&&kh_js.isEmpty(keys))return"";return keys.map(((key,i)=>{let s=unzip(storage,key);return strings[i]+(!kh_js.isEmpty(s)?s:key)})).join("")+strings[strings.length-1]}export function processTaggedComplex(storage,strings,...keys){if(kh_js.isEmpty(strings)&&kh_js.isEmpty(keys))return"";return unzipProp(storage,processTagged(storage,strings,...keys))}export class Error extends(kh_io.HTTPError(kh_js.Error)){constructor(){super(...arguments)}}kh_global.LoadedScripts.get(mf).resolve(ms);